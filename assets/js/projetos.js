// Se tiver estrela no git hub, eu ja cadastrei aqui
const projetos = [
    {
        nome: "Sala master",
        categoria: "FullStack",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/SalaMaster/refs/heads/main/public/preview/login.png",
            "https://raw.githubusercontent.com/Joaofelipe14/SalaMaster/refs/heads/main/public/preview/lista_mensagens.png",
            "https://raw.githubusercontent.com/Joaofelipe14/SalaMaster/refs/heads/main/public/preview/tela_horarios.png",],
        detalhes: "Aplicativo com diversas funcionalidades como cadastro de professores, turmas e disicplinas, assim o coordenado/responsavel pode usar o sistema para vincular o professor a sua grade de horário.",
        link: 'https://github.com/Joao  felipe14/SalaMaster',
        tecnologias: ['logos:php', 'logos:javascript', 'logos:mysql', 'logos:html-5', 'logos:css-3']
    },
    {
        nome: "Prime Flix",
        categoria: "Frontend",
        imagem: [
            "https://user-images.githubusercontent.com/86098025/198722129-e0df2c00-d7fe-4f4f-bf00-88d20a8a65e1.png",
            "https://user-images.githubusercontent.com/86098025/198722142-34dc0c7d-a411-4b9b-a493-b1308ca3a6f9.png",
        ],
        detalhes: "App para listar/salvar filmes que estão no cinema consome API do themoviedb.",
        link: 'https://github.com/Joaofelipe14/SalaMaster',
        tecnologias: ['logos:react', 'logos:javascript', 'logos:html', 'logos:html-5', 'logos:css-3']
    },
    {
        nome: "One Piece",
        categoria: "Frontend",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/Projeto-One-Peace/refs/heads/main/src/imagens/image.png",
            "https://raw.githubusercontent.com/Joaofelipe14/Projeto-One-Peace/refs/heads/main/src/imagens/imagecelular.png"
        ],
        detalhes: "Este projeto consiste em uma página web que apresenta informações sobre alguns personagens do anime/mangá One Piece e permite ao usuário selecionar um personagem da tripulação dos Piratas do Chapéu de Palha para exibir detalhes sobre ele. ",
        link: "https://github.com/Joaofelipe14/Projeto-One-Peace",
        tecnologias: ['logos:javascript', 'logos:html', 'logos:html-5', 'logos:css-3']
    },
    {
        nome: "Cadastro de carro TypeScprit Pwa",
        categoria: "Frontend",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/cadastro-carro-crud-pwa/refs/heads/main/src/assets/image.png",
        ],
        detalhes: "Projeto simples para poder fazer o crud, de cadastro de carros, usando angular, PWA",
        link: "https://github.com/Joaofelipe14/cadastro-carro-crud-pwa",
        tecnologias: ['logos:javascript', 'logos:html', 'logos:html-5', 'logos:angular-icon', 'logos:pwa']
    },
    {
        nome: "Gerenciado de tarefas",
        categoria: "FullStack",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/Gerenciamento-de-Tarefas/refs/heads/main/preview/login.png",
            "https://raw.githubusercontent.com/Joaofelipe14/Gerenciamento-de-Tarefas/refs/heads/main/preview/documenta%C3%A7ao.png",
            "https://raw.githubusercontent.com/Joaofelipe14/Gerenciamento-de-Tarefas/refs/heads/main/preview/cria_task.png",
            "https://raw.githubusercontent.com/Joaofelipe14/Gerenciamento-de-Tarefas/refs/heads/main/preview/create_task.png",


        ],
        detalhes: "Projeto completo front e back-end para cadastro de tarefas com interface de login e cadastro",
        link: "https://github.com/Joaofelipe14/Gerenciamento-de-Tarefas",
        tecnologias: ['logos:javascript', 'logos:vue', 'logos:html-5', 'logos:php', 'logos:mysql']
    },
    {
        nome: "chat Bot - Controle financeiro",
        categoria: "Outros",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/Chat-bot-whats-financeiro/refs/heads/main/src/assets/2.jpeg",
            "https://raw.githubusercontent.com/Joaofelipe14/Chat-bot-whats-financeiro/refs/heads/main/src/assets/1.jpeg"


        ],
        detalhes: "Este projeto visa criar um sistema de controle financeiro pessoal utilizando o WhatsApp Web, Node.js e Prisma para gerenciamento de dados. O objetivo é permitir que o usuário registre suas receitas e despesas diretamente pelo WhatsApp, com categorias personalizáveis, geração de gráficos financeiros e sugestões de economia ou investimentos quando houver saldo positivo.",
        link: "",
        tecnologias: ['logos:node', 'logos:mysql', 'logos:html-5', 'logos:php', 'logos:mysql']
    },
    {
        nome: "Sistema de futebol",
        categoria: "FullStack",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/Futeboll-system/refs/heads/main/public/images/prints/1.png",
            "https://raw.githubusercontent.com/Joaofelipe14/Futeboll-system/refs/heads/main/public/images/prints/2.png",
            "https://raw.githubusercontent.com/Joaofelipe14/Futeboll-system/refs/heads/main/public/images/prints/3.png"
        ],
        detalhes: "Este projeto foi desenvolvido em Laravel para consumir dados da Football Data API e exibir informações sobre times de futebol, como nome, ano de fundação, estádio e jogadores. O projeto segue uma estrutura MVC, com a adição de um Service para separar a lógica de negócio da lógica de controle.",
        link: "https://github.com/Joaofelipe14/Futeboll-system",
        tecnologias: ['logos:blade', 'logos:laravel', 'logos:html-5', 'logos:php', 'logos:mysql']
    }, {
        nome: "GameList",
        categoria: "Backend",
        imagem: [
            "./assets/images/gamelist.png"

        ],
        detalhes: "O DSList é um projeto desenvolvido com o objetivo de ensinar os fundamentos do desenvolvimento de APIs utilizando Java e Spring Boot. O foco principal é construir uma aplicação de gerenciamento de listas de jogos, permitindo criar, editar e excluir jogos em uma lista específica. A aplicação utiliza o padrão DTO (Data Transfer Object), JPA (Java Persistence API), e é configurada para trabalhar com diferentes ambientes de banco de dados, como H2 para testes e PostgreSQL para produção.",
        link: "https://github.com/Joaofelipe14/GamesList",
        tecnologias: ['logos:java', 'logos:html-5', 'logos:php', 'logos:mysql', 'logos:postgresql']
    },
    {
        nome: "Compilador",
        categoria: "Outros",
        imagem: [
            "https://joaofelipe14.github.io/Portifoliov2/assets/images/Compilador_jack.png"

        ],
        detalhes: "Compilador desenvolvido em java para interpretar a linguagem jack. Este projeto visa implementar um compilador em duas etapas. A análise léxica implementada manualmente ou com auxílio de expressões regulares. Ultilizando um analisador sintático preditivo implementado manualmente, sem a geração de uma Árvore Sintática Abstrata (AST). Em vez disso, irar ser gerado diretamente uma representação intermediária (stack-based). Execução do projeto: https://www.youtube.com/watch?v=auyDeCz0hv0",
        link: "https://github.com/Joaofelipe14/jackcompiler",
        tecnologias: ['logos:java']
    },
    {
        nome: "Detectação de KeyPoints na Mão",
        categoria: "Outros",
        imagem: [
            "https://joaofelipe14.github.io/Portifoliov2/assets/images/Yolo_POse_v8.gif"

        ],
        detalhes: "Este é um projeto desenvolvido em Python utilizando o modelo YOLO Pose V8. O objetivo é detectar e comparar os pontos de referência (keypoints) em vídeos diferentes, aplicando filtros de movimentos específicos das mãos.",
        link: "https://github.com/Joaofelipe14/Yolov8_KeypointDetected",
        tecnologias: ['logos:python', 'logos:yolo', 'logos:Ia', 'logos:php', 'logos:mysql']
    },
    {
        nome: "Aspirador de pó",
        categoria: "Outros",
        imagem: [
            "https://joaofelipe14.github.io/Portifoliov2/assets/images/Aspirado_de_po.png"
        ],
        detalhes: "Desenvolvido em python, foi gerado um ambiente em forma de matriz e o aspirado de pó busca, a maneira a trajetoria mais eficiente de ir onde está 'sujo' para poder limpar.",
        link: "",
        tecnologias: ['logos:python']
    },
    {
        nome: "Pizzaria",
        categoria: "FullStack",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/Pizzaria/refs/heads/main/Frontend/src/images/2.png",
            "https://raw.githubusercontent.com/Joaofelipe14/Pizzaria/refs/heads/main/Frontend/src/images/1.png"


        ],
        detalhes: "Projeto de sistema de pizzaria, criação de cadastro de úsuarios cardipios e ordem de pedido",
        link: "",
        tecnologias: ['logos:typescript', 'logos:react', 'logos:html', 'logos:node', 'logos:mysql']
    },
    {
        nome: "Ds movie",
        categoria: "FullStack",
        imagem: [
            "https://user-images.githubusercontent.com/86098025/198722629-c00579f7-a1b6-4297-a670-7c7847709f06.png",

        ],
        detalhes: "Projeto desenvolvido o Back end em java para servi como uma Api, Bancos de dados postgresql e front com React.",
        link: "https://github.com/Joaofelipe14/Projeto-movie",
        tecnologias: ['logos:java', 'logos:react', 'logos:html-5', 'logos:springboot', 'logos:postgresql']
    },
    {
        nome: "Pokedex",
        categoria: "Frontend",
        imagem: [
            "assets/images/pokedex2.png",
            "assets/images/pokedex1.png"


        ],
        detalhes: "Este projeto é uma aplicação desenvolvida em Angular e Ionic, com o propósito de criar uma Pokédex que consome dados da API Pokémons v2. A aplicação é configurada como um Progressive Web App (PWA), possibilitando seu funcionamento offline. Os principais recursos incluem a capacidade de salvar pokémons favoritos localmente, listar todos os pokémons disponíveis e visualizar os detalhes de cada um.",
        link: "",
        tecnologias: ['logos:ionic', 'logos:angular-icon', 'logos:pwa-icon']
    },
    {
        nome: "SAS dias das mulheres",
        categoria: "Outros",
        imagem: [
            "assets/images/diadamulher1.png",
            "assets/images/diadamulher2.png",

        ],
        detalhes: "App dinamico que conta com o cadastro com informações pessoais, da mulher. E gera um link especifico para a pessoa. Integrado com api do supaBase. ",
        link: "",
        tecnologias: ['logos:html-5', 'logos:css-3', 'logos:supabase']
    },
    {
        nome: "CoopDelta - A app registro de pesca.",
        categoria: "Fullstack",
        imagem: [
            "assets/images/coopdelta5.png",
            "assets/images/coopdelta3.png",
            "assets/images/coopdelta4.png",
            "assets/images/coopdelta2.png",

        ],
        detalhes: "Software (PATENTIADO) para otimização de custeio e rastreabilidade do pescado de caranguejo na região de Araioses-MA, O software proposto é projetado para enfrentar os desafios mencionados ao permitir que os usuários acompanhem todo o ciclo de vida dos caranguejos. Sistemas de software de gestão, como o proposto, são ferramentas importantes para melhorar a eficiência operacional e a transparência, facilitando a tomada de decisões.",
        link: "https://demopesca.netlify.app/",
        tecnologias: ['logos:ionic', 'logos:angular-icon', 'logos:mysql', 'logos:pwa', 'logos:php']
    },
    {
        nome: "Lista de tarefas",
        categoria: "Frontend",
        imagem: [
            "https://raw.githubusercontent.com/Joaofelipe14/Lista-tarefas/refs/heads/main/src/assets/image.png",

        ],
        detalhes: "Este é um projeto React que inclui um componente chamado 'Filter'. O componente 'Filter' é responsável por adicionar opções de filtragem e ordenação a uma lista de tarefas.",
        link: "https://github.com/Joaofelipe14/Lista-tarefas",
        tecnologias: ['logos:react', 'logos:css-3']
    },

];

document.addEventListener('DOMContentLoaded', () => {
    // Selecionar os elementos
    const filterButtons = document.querySelectorAll('[data-filter-btn]');
    const select = document.querySelector("[data-select]");
    const selectItems = document.querySelectorAll("[data-select-item]");
    const selectValue = document.querySelector("[data-select-value]");

    if (filterButtons.length > 0) {
        filterButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                const categoria = e.target.getAttribute('data-filter');
                renderizarProjetos(categoria);
                updateActiveFilterButton(categoria);
            });
        });
    } else {
        console.error('Botões de filtro não encontrados.');
    }

    const updateActiveFilterButton = (categoria) => {
        filterButtons.forEach(btn => btn.classList.remove("active"));
        const activeButton = document.querySelector(`[data-filter-btn][data-filter="${categoria}"]`);
        if (activeButton) {
            activeButton.classList.add("active");
        }
    };

    const elementToggleFunction = (element) => {
        element.classList.toggle("active");
    };

    if (select) {
        select.addEventListener("click", function () {
            elementToggleFunction(this);
        });
    }

    if (selectItems.length > 0) {
        selectItems.forEach(item => {
            item.addEventListener("click", function (e) {
                const categoriaSelecionada = e.target.getAttribute("data-filter");
                selectValue.textContent = e.target.textContent;
                elementToggleFunction(select);
                renderizarProjetos(categoriaSelecionada);
                updateActiveFilterButton(categoriaSelecionada);
            });
        });
    }

    renderizarProjetos('all');
});


function limitarTexto(texto, limite = 50) {
    if (texto.length > limite) {
        return texto.substring(0, limite) + ' ...';
    }
    return texto;
}


// Função para renderizar projetos no HTML
function renderizarProjetos(categoriaFiltro = "all") {
    const listaProjetos = document.getElementById('project-list');
    listaProjetos.innerHTML = '';

    const ordemCategorias = ['FullStack', 'Frontend', 'Backend', 'Outros'];

    const projetosFiltrados = categoriaFiltro === 'all' ? projetos : projetos.filter(projeto => projeto.categoria === categoriaFiltro);

    const projetosOrdenados = projetosFiltrados.sort((a, b) => {
        const categoriaA = ordemCategorias.indexOf(a.categoria);
        const categoriaB = ordemCategorias.indexOf(b.categoria);

        if (categoriaA !== categoriaB) {
            return categoriaA - categoriaB;
        }

        return b.imagem.length - a.imagem.length;
    });

    projetosOrdenados.forEach(projeto => {
        const item = document.createElement('li');
        item.classList.add('project-item', 'active');
        item.setAttribute('data-category', projeto.categoria);

        item.innerHTML = `
        <a href="#">
          <figure class="project-img">
            <div class="project-item-icon-box">
              <ion-icon name="eye-outline"></ion-icon>
            </div>
            <img src="${projeto.imagem[0]}" alt="${projeto.nome}" loading="lazy"> <!-- Primeira imagem do array -->
          </figure>
          <h3 class="project-title">${projeto.nome}</h3>
          <p class="project-category">
      <span class="short-text" style="font-size: 14px;">${limitarTexto(projeto.detalhes)}</span> <!-- Limitar o texto -->
          </p>
        </a>
      `;

        listaProjetos.appendChild(item);
    });
}

document.addEventListener('DOMContentLoaded', () => {
    const projectModal = document.getElementById('project-modal');
    const closeProjectModalBtn = document.getElementById('close-project-modal-btn');
    const overlay = document.querySelector('[data-overlay]');
    const projectImage = document.querySelector('[data-project-modal-img]');
    const projectTitle = document.querySelector('[data-project-modal-title]');
    const projectCategory = document.querySelector('[data-project-modal-category]');
    const techIconsContainer = document.querySelector('[data-project-modal-technologies]');
    const githubLinkContainer = document.querySelector('[data-project-modal-github]');

    let currentImageIndex = 0;
    let imagens = '';

    // Função para resetar os dados do modal
    function resetModal() {
        projectTitle.textContent = '';
        projectCategory.textContent = '';
        projectImage.src = '';
        techIconsContainer.innerHTML = '';
        githubLinkContainer.textContent = '';
        currentImageIndex = 0;
        resetIndicators()
    }

    const indicatorsContainer = document.getElementById('carousel-indicators');
    indicatorsContainer.innerHTML = '';

    const resetIndicators = () => {
        currentImageIndex = 0;  // Resetando o índice para a primeira imagem
        const allIndicators = indicatorsContainer.querySelectorAll('span');
        allIndicators.forEach(indicator => indicator.classList.remove('active'));
        if (allIndicators.length > 0) {
            allIndicators[currentImageIndex].classList.add('active');  // Adiciona a classe "active" ao primeiro indicador
        }
    };
    
    const updateIndicators = () => {
        const allIndicators = indicatorsContainer.querySelectorAll('span');
        allIndicators.forEach(indicator => indicator.classList.remove('active'));
        allIndicators[currentImageIndex].classList.add('active');
    };


    // Função para atualizar os botões de navegação
    function updateNavigationButtons() {
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');

        // Desabilita o botão de "anterior" se for a primeira imagem
        if (currentImageIndex === 0) {
            prevBtn.disabled = true;
        } else {
            prevBtn.disabled = false;
        }

        // Desabilita o botão de "próximo" se for a última imagem
        if (currentImageIndex === imagens.length - 1) {
            nextBtn.disabled = true;
        } else {
            nextBtn.disabled = false;
        }
    }

    function atualizarImagem() {
        projectImage.src = imagens[currentImageIndex];
        updateIndicators();
        updateNavigationButtons();
    }
    // Função para ir para a próxima imagem
    function nextImage() {
        if (currentImageIndex < imagens.length - 1) {
            currentImageIndex++;
        }
        atualizarImagem();
    }

    // Função para ir para a imagem anterior
    function prevImage() {
        if (currentImageIndex > 0) {
            currentImageIndex--;
        }
        atualizarImagem();
    }

    function abrirModal(projeto) {
        resetModal();
        imagens = projeto.imagem;
        currentImageIndex = 0;
        projectTitle.textContent = projeto.nome;
        projectCategory.textContent = projeto.detalhes;
        projectImage.src = imagens[currentImageIndex]; 
        techIconsContainer.textContent = '';

        const indicatorsContainer = document.getElementById('carousel-indicators');
        indicatorsContainer.innerHTML = '';  // Limpa os indicadores existentes

        projeto.tecnologias.forEach(tech => {
            const techIcon = document.createElement('span');
            techIcon.classList.add('iconify');
            techIcon.setAttribute('data-icon', tech);
            techIconsContainer.appendChild(techIcon);
        });

        if (projeto.link) {
            githubLinkContainer.textContent = projeto.link;
            githubLinkContainer.href = projeto.link;
            githubLinkContainer.target = '_blank';
        } else {
            githubLinkContainer.textContent = '';
        }

        // Exibir o modal
        projectModal.classList.add('active');
        overlay.classList.add('active');

        // Criação dos indicadores de bolinhas


        // Criação de bolinhas conforme o número de imagens
        imagens.forEach((_, index) => {
            const indicator = document.createElement('span');
            indicator.setAttribute('data-index', index);
            indicatorsContainer.appendChild(indicator);
        });

        // Marcar o indicador ativo


        // Atualiza a imagem



        // Seleciona os botões corretamente
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');

        // Remove ouvintes anteriores para evitar duplicação
        nextBtn.removeEventListener('click', nextImage(currentImageIndex)); 
        prevBtn.removeEventListener('click', prevImage(currentImageIndex)); 

        // Adiciona novos ouvintes
        nextBtn.addEventListener('click', nextImage); 
        prevBtn.addEventListener('click', prevImage); 

        if (imagens.length === 1) {
            prevBtn.disabled = true;
            nextBtn.disabled = true;
        }

        updateIndicators();
        updateNavigationButtons();
    }

    function fecharModal() {
        projectModal.classList.remove('active');
        overlay.classList.remove('active');
        resetModal();
    }

    if (closeProjectModalBtn) {
        closeProjectModalBtn.addEventListener('click', fecharModal);
    }

    if (overlay) {
        overlay.addEventListener('click', fecharModal);
    }

    const projectList = document.getElementById('project-list');
    if (projectList) {
        projectList.addEventListener('click', (e) => {
            const projectItem = e.target.closest('.project-item');
            if (!projectItem) return;

            const projectName = projectItem.querySelector('.project-title').textContent;
            const projetoSelecionado = projetos.find(projeto => projeto.nome === projectName);
            if (projetoSelecionado) {
                abrirModal(projetoSelecionado);
            }
        });
    }
});
